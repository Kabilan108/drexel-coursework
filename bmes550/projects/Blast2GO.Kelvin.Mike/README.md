# Rapid Functional Annotation of a Gene
#### By Kelvin Koser & Michael Welsh
#### BMES 550 Fall 2022

## Files

### Initial Files
#### frontend.py
Script that establishes GUI as well as accepting input nucleotide sequence as well as outputting eventual DataFrame/table of results. This script will feed the queried nucleotide sequence to the backend.py script. Furthermore, provides the ability to download the resulting DataFrame as a .csv file, and caches previous queries in case of a repeat query.

#### backend.py
Script that accepts the nucleotide sequence from frontend.py, piping that as input to the get_BLAST_results function. This function executes BLAST to identify the genes most similar to the queried sequence, based on E-value. This is then piped to the blast_query function, which first determines all known Gene Ontology (GO) annotations pertaining to that sequence, and finally defines what each GO term encodes. This resulting DataFrame is then fed back to the frontend.py script.

#### make_db.py
An optional script that generates a database, if one is not present in the local directory. Note that this database is specific to the nucleotide accession numbers, GO annotations, and GO descriptions relevant only to Homo sapiens (taxid: 9606)

#### index.yml
A short yaml file that provides information relevant for a citation. 

#### design.pptx
PowerPoint file that shows various information about the structure of the tool/pipeline, including workflow, database schema, and an overview of each function utilized.

#### favicon.ico
Thumbnail icon utilized for GUI/project.

#### sketch.png
An overview of the project in its early draft stages.

#### presentation.pptx
The PowerPoint presentation pertaining to this project.

#### gene2_accession_human_filt
A liftover file that contains all documented human gene accession numbers as well as gene_ID values. This is necessary for creating the gene_annotation_liftover.csv file.

#### hbb_sample.txt
A sample sequence of human hemoglobin subunit beta gene. This can be fed into the gui.

#### brca2_example.txt
A fragment of the human brca2 gene. This can also be fed into the gui as an example.


### Files Generated By Pipeline
#### gene_annotation_liftover.csv
A liftover file that is used to create the first table (gene annotation) in the database. Contains the following information: (1) nucleotide accession (nt_accession), (2) gene symbol (symbol), and (3) GO annotation terms (GO_ID).

#### gene2go
File that is downloaded when running the make_db.py script. Contains the information necessary to make a gene_ontology_liftover.csv file.

#### gene_ontology_liftover.csv
File used to create the second table (gene ontology) in the database. Contains the following information: (1) Gene ontology ID (GO_ID), (2) GO term description (description), and (3) GO term class (class). 

#### go-basic.obo
File created when running the make_db.py script. Contains the descriptors and class names pertaining to each GO term.

#### gene_db
The database pertaining to this tool. Contains two tables: (1) that attributes GO annotations to a nucleotide sequence based on accession number, and (2) that provides descriptions for each pertinent GO annotation.

#### cache.csv
A .csv file that stores previously-queried sequences as well as their resulting DataFrames.


## Installation Instructions
### Required packages:
    - pandas
    - numpy
    - PySimpleGUI
    - Biopython
    - sqlite3
    - flit_core


### Files to download beforehand
This file should be provided in the original zipped directory. Alternatively, this can be recreated by downloading the gene2accession_human_filt file was procurred from https://ftp.ncbi.nlm.nih.gov/gene/DATA/. This can be recreated by filtering the full file from ncbi to those only pertaining to Homo sapiens (taxid: 9606).

### Instructions:

#### Make environment
1. Ensure conda is installed. This can be checked by typing "which conda" on the command line. 
2. Create conda environment by running the following command "conda env create -f make_env.yml"
3. Activate the environment by typing "conda activate blast2go_env"
4. Sqlite3 is a bit tricky to install. To do so, type "conda install -c blaze sqlite3"

**Note â€“ creating the environment from a yaml file can take a while. In the event that it doesn't work, you can install packages directly from conda. For help with this, simply search "conda install [package name]".

#### Make Database
To make the database from which the scripts will query, simply run the make_db.py file. This can be done from the command line by typing "python make_db.py". This will take a few minutes. Once it is finished, make sure you see "gene_db" in the directory.

#### Run Tool
To run the tool, simply run the frontend.py script. To do this, type "python frontend.py". This will generate the GUI, from which you can enter a nucleotide sequence (ACG or T). To test this, copy the data from the brca2_sample.txt, and paste it into the GUI, clicking submit afterwards. Once the tool has finished running, 